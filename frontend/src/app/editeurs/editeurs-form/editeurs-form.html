<div class="editeurs-form">
  <h2>@if (editeurToEdit) { Modifier l'éditeur } @else { Ajouter un éditeur }</h2>

  @if (error) {
    <p class="error">{{ error }}</p>
  }

  <form (ngSubmit)="submit()">
    <div class="form-row">
      <label for="nom">Nom de l'éditeur</label>
      <input
        id="nom"
        type="text"
        [(ngModel)]="nom"
        name="nom"
        required
        placeholder="Nom de la maison d'édition"
      />
    </div>

    <h3>Contacts</h3>
    
    @if (contacts.length === 0) {
      <p class="info">Aucun contact pour le moment.</p>
    } @else {
      <div class="contacts-list">
        @for (contact of contacts; track $index) {
          <div class="contact-form">
            <div class="form-row">
              <label for="contactNom{{ $index }}">Nom *</label>
              <input
                [id]="'contactNom' + $index"
                type="text"
                [(ngModel)]="contact.nom"
                [name]="'contactNom' + $index"
                placeholder="Nom du contact"
              />
            </div>

            <div class="form-row">
              <label [for]="'contactEmail' + $index">Email</label>
              <input
                [id]="'contactEmail' + $index"
                type="email"
                [(ngModel)]="contact.email"
                [name]="'contactEmail' + $index"
                placeholder="ex: contact@editeur.com"
              />
            </div>

            <div class="form-row">
              <label [for]="'contactTel' + $index">Téléphone</label>
              <input
                [id]="'contactTel' + $index"
                type="text"
                [(ngModel)]="contact.telephone"
                [name]="'contactTel' + $index"
                placeholder="ex: 06..."
              />
            </div>

            <div class="form-row">
              <label [for]="'contactRole' + $index">Rôle / fonction</label>
              <input
                [id]="'contactRole' + $index"
                type="text"
                [(ngModel)]="contact.role_profession"
                [name]="'contactRole' + $index"
                placeholder="ex: Responsable commercial"
              />
            </div>

            <button type="button" (click)="removeContact($index)" class="btn-remove">
              Supprimer ce contact
            </button>
          </div>
        }
      </div>
    }

    <button type="button" (click)="addContact()" class="btn-add-contact">
      Ajouter un contact
    </button>

    <div class="form-actions">
      <button type="submit" [disabled]="loading">
        @if (loading) { 
          Sauvegarde... 
        } @else { 
          @if (editeurToEdit) { Modifier } @else { Créer l'éditeur }
        }
      </button>
      @if (editeurToEdit) {
        <button type="button" (click)="cancel()" [disabled]="loading">Annuler</button>
      }
    </div>
  </form>
</div>



